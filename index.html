<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no" />

  <title>å¯äº‘</title>

  <!-- umi.jsï¼šä¿æŒä¸å˜ -->
  <script type="module" crossorigin src="/assets/umi.js"></script>

  <!-- å¼•å…¥æŠ˜å åŠŸèƒ½æ ·å¼ -->
  <link rel="stylesheet" href="/assets/plan.css">

  <!-- ç™»å½•èƒŒæ™¯è‡ªå®šä¹‰å˜é‡ -->
  <style>
    :root {
      --login-bg: url('/assets/login-bg.jpg');
    }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: #f5f6f8;
    }

    /* æŒ‰é’®åŒºåŸŸ */
    .ky-entry-buttons {
      position: fixed;
      bottom: 40px;
      right: 40px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 10000;
    }

    .ky-entry-buttons a,
    .ky-entry-buttons button {
      text-decoration: none;
      color: white;
      background: linear-gradient(135deg, #ff7e96, #ffafc2);
      border-radius: 12px;
      padding: 12px 22px;
      font-weight: 600;
      font-size: 15px;
      box-shadow: 0 4px 16px rgba(255, 118, 146, 0.35);
      transition: all 0.25s ease;
      text-align: center;
      border: none;
      cursor: pointer;
    }

    .ky-entry-buttons a:hover,
    .ky-entry-buttons button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255, 118, 146, 0.45);
    }

    /* æ–°äººå…¬å‘Šå¼¹çª—æ ·å¼ */
    .notice-mask {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.55);
      backdrop-filter: blur(4px);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 999999;
    }

    .notice-box {
      width: 82%;
      max-width: 380px;
      background: #fff;
      padding: 20px;
      border-radius: 18px;
      text-align: center;
      animation: ky-popup .3s ease;
      box-shadow: 0 12px 35px rgba(0,0,0,0.16);
    }

    .notice-close {
      font-size: 22px;
      cursor: pointer;
      text-align: right;
      margin-bottom: 8px;
    }

    @keyframes ky-popup {
      from { transform: scale(.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
  </style>
</head>

<body>

  <!-- ç¯å¢ƒé…ç½® -->
  <script src="./env.example.js"></script>

  <div id="app"></div>

  <!-- âœ… ç™»å½•/æ³¨å†ŒæŒ‰é’®åŒºåŸŸ -->
  <div class="ky-entry-buttons">
    <!-- ç™»å½•æŒ‰é’®ï¼šä¿ç•™åˆ†ç«™ -->
    <button onclick="location.href='#/login'">ç™»å½•</button>

    <!-- æ³¨å†ŒæŒ‰é’®ï¼šè·³ä¸»ç«™ -->
    <a href="https://ss.shy521.com/#/register?from=koyun" target="_blank">æ³¨å†Œè´¦æˆ·</a>
  </div>

  <!-- ======================== æŠ˜å åŠŸèƒ½å‡½æ•° ======================== -->
  <script>
    function togglePlan(elem) {
      const content = elem.previousElementSibling;
      if (content.style.maxHeight) {
        content.style.maxHeight = null;
        elem.innerText = "å±•å¼€è¯¦æƒ…";
        content.classList.remove("open");
      } else {
        content.style.maxHeight = content.scrollHeight + "px";
        elem.innerText = "æ”¶èµ·è¯¦æƒ…";
        content.classList.add("open");
      }
    }
  </script>

  <!-- ======================== è‡ªåŠ¨æ³¨å…¥æŠ˜å å¡ç‰‡åˆ° /plan ======================== -->
  <script>
  (function () {
      function injectPlanCard() {
        const hash = location.hash.replace('#', '');
        if (hash.startsWith('/plan')) {
          const container =
            document.querySelector('.ant-pro-page-container-children-container') ||
            document.querySelector('.ant-pro-children-content');
          if (!container) return setTimeout(injectPlanCard, 300);
          if (document.getElementById('ky-plan-card')) return;
          const html = `
            <div id="ky-plan-card" class="plan-card">
              <div class="plan-title">Premium å¥—é¤</div>
              <div class="plan-subtitle">é«˜é€Ÿ / å¥—é¤è¯´æ˜ / GPT ä¼˜åŒ–</div>
              <div class="plan-content">
                <p>- è§£é”æµåª’ä½“ï¼ˆNetflix / Disney+ï¼‰</p>
                <p>- GPT ä¸“çº¿ï¼Œä½å»¶è¿Ÿé«˜ç¨³å®š</p>
                <p>- ä¸é™é€Ÿã€ä¸é™è®¾å¤‡æ•°ï¼ˆåˆç†ä½¿ç”¨ï¼‰</p>
                <p>- å« HK / JP / TW / US èŠ‚ç‚¹æ± </p>
              </div>
              <div class="plan-toggle" onclick="togglePlan(this)">å±•å¼€è¯¦æƒ…</div>
            </div>`;
          container.insertAdjacentHTML('afterbegin', html);
        }
        setTimeout(injectPlanCard, 500);
      }
      injectPlanCard();
  })();
  </script>

  <!-- ======================== ç™»å½•æˆåŠŸåŒå¼¹çª—é€»è¾‘ ======================== -->
  <script>
  (function () {
    const DASHBOARD_PATH = "/dashboard"; 
    let popupInitialized = false;
    let firstClosed = false;
    let secondShown = false;

    function createNoticePopup(onClose) {
      const mask = document.createElement("div");
      mask.className = "notice-mask";
      mask.innerHTML = `
        <div class="notice-box">
          <div class="notice-close" id="noticeClose">Ã—</div>
          <h2>ğŸ“¢ æ–°äººå¿…çœ‹å…¬å‘Š</h2>
          <p style="line-height:1.6;">æ¬¢è¿æ¥åˆ°å¯äº‘ï¼Œè¯·åŠ¡å¿…é˜…è¯»é¡¶éƒ¨å…¬å‘Šæ ä¿¡æ¯ã€‚</p>
          <p style="line-height:1.6;">è¯·æ”¶è—æœ€æ–°åœ°å€ï¼š<b>shy521.com</b></p>
          <p style="line-height:1.6;margin-bottom:18px;">
            åŠ å…¥ TG ç¾¤ç»„ï¼š<a href="https://t.me/ss_keyun" target="_blank">t.me/ss_keyun</a>
          </p>
        </div>`;
      document.body.appendChild(mask);
      mask.querySelector("#noticeClose").onclick = () => {
        mask.remove();
        if (typeof onClose === "function") onClose();
      };
    }

    function watchDashboardRoute() {
      setInterval(() => {
        const hashPath = location.hash.replace("#", "");
        if (!popupInitialized && hashPath.startsWith(DASHBOARD_PATH)) {
          popupInitialized = true;
          startTwoPopups();
        }
      }, 300);
    }

    function startTwoPopups() {
      setTimeout(() => {
        createNoticePopup(() => {
          firstClosed = true;
          startSecondPopupMonitor();
        });
      }, 1500);
    }

    function startSecondPopupMonitor() {
      let monitorActive = true;
      function clickHandler() {
        if (!monitorActive || secondShown) return;
        monitorActive = false;
        document.removeEventListener("click", clickHandler, true);
        const delay = 3000 + Math.floor(Math.random() * 7000);
        setTimeout(() => {
          if (!secondShown) {
            secondShown = true;
            createNoticePopup();
          }
        }, delay);
      }
      document.addEventListener("click", clickHandler, true);
      setTimeout(() => {
        monitorActive = false;
        document.removeEventListener("click", clickHandler, true);
      }, 60000);
    }

    watchDashboardRoute();
  })();
  </script>

</body>
</html>
